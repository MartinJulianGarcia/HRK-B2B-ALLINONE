<div class="profile-container">
  <!-- Header con navegación -->
  <div class="profile-header">
    <button class="back-btn" (click)="goBack()" title="Volver">
      ←
    </button>
    <h1 class="page-title">Mi Perfil</h1>
  </div>

  <!-- Separador -->
  <div class="separator"></div>

  <!-- Contenido principal -->
  <div class="profile-content">
    <!-- Tarjeta superior: Resumen del perfil y acciones -->
    <div class="profile-card">
      <div class="profile-info">
        <div class="profile-icon">
          <div class="user-avatar">
            <img src="/images/profile/default-user.png" alt="Usuario" class="avatar-image">
          </div>
        </div>
        <div class="user-details">
          <h2 class="user-name">{{ user?.nombreRazonSocial || 'Usuario' }}</h2>
          <p class="user-email">{{ user?.email || 'email@ejemplo.com' }}</p>
        </div>
      </div>
      
      <div class="action-buttons">
        <button class="btn btn-primary" (click)="editProfile()" *ngIf="!editando">
          Editar Perfil
        </button>
        <button class="btn btn-secondary" (click)="viewOrderHistory()" *ngIf="!editando">
          Ver Historial de Pedidos
        </button>
        <button class="btn btn-outline" (click)="logout()" *ngIf="!editando">
          Cerrar Sesión
        </button>
      </div>
    </div>

    <!-- Tarjeta inferior: Información de la cuenta -->
    <div class="info-card">
      <h3 class="card-title">Información de la cuenta</h3>
      
      <!-- Modo visualización -->
      <ng-container *ngIf="!editando">
        <div class="info-row">
          <span class="info-label">Usuario:</span>
          <span class="info-value">{{ user?.nombreRazonSocial || 'N/A' }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Email:</span>
          <span class="info-value">{{ user?.email || 'N/A' }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Miembro desde:</span>
          <span class="info-value">{{ memberSince }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Rol actual:</span>
          <span class="info-value">{{ user?.tipoUsuario || 'N/A' }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">CUIT:</span>
          <span class="info-value">{{ user?.cuit || 'N/A' }}</span>
        </div>
        <div class="info-row">
          <button class="btn btn-secondary" (click)="cambiarRol()">
            Cambiar a {{ user?.tipoUsuario === 'CLIENTE' ? 'ADMIN' : 'CLIENTE' }}
          </button>
        </div>
      </ng-container>

      <!-- Modo edición -->
      <ng-container *ngIf="editando">
        <div class="edit-form">
          <div class="form-group">
            <label for="nombreRazonSocial" class="form-label">Nombre / Razón Social:</label>
            <input 
              type="text" 
              id="nombreRazonSocial" 
              name="nombreRazonSocial" 
              [(ngModel)]="editForm.nombreRazonSocial" 
              class="form-control"
              required
              [disabled]="guardando"
            >
          </div>

          <div class="form-group">
            <label for="cuit" class="form-label">CUIT:</label>
            <input 
              type="text" 
              id="cuit" 
              name="cuit" 
              [(ngModel)]="editForm.cuit" 
              class="form-control"
              required
              [disabled]="guardando"
            >
          </div>

          <div class="form-group">
            <label class="form-label">Email:</label>
            <input 
              type="email" 
              [value]="user?.email || ''" 
              class="form-control"
              disabled
            >
            <small class="form-text">El email no se puede modificar</small>
          </div>

          <div *ngIf="error" class="error-message">
            {{ error }}
          </div>

          <div class="form-actions">
            <button 
              class="btn btn-primary" 
              (click)="guardarCambios()" 
              [disabled]="guardando"
            >
              <span *ngIf="!guardando">Guardar Cambios</span>
              <span *ngIf="guardando">Guardando...</span>
            </button>
            <button 
              class="btn btn-outline" 
              (click)="cancelarEdicion()" 
              [disabled]="guardando"
            >
              Cancelar
            </button>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</div>
